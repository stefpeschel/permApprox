% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_gpd.R
\name{fit_gpd}
\alias{fit_gpd}
\title{Fit and test the Generalized Pareto Distribution (GPD)}
\usage{
fit_gpd(
  data,
  thresh = NULL,
  fit_method = "MLE1D",
  tol = 1e-08,
  eps_fun = eps_power,
  eps_par = list(),
  constraint = "unconstrained",
  support_boundary = NULL,
  gof_test = "ad",
  ...
)
}
\arguments{
\item{data}{Numeric vector of observations.}

\item{thresh}{Numeric scalar; exceedance threshold.}

\item{fit_method}{Character string specifying the fitting method to be used.
Must be one of \code{"LME"}, \code{"MLE1D"}, \code{"MLE2D"}, \code{"MOM"},
\code{"NLS2"}, \code{"WNLLSM"}, or \code{"ZSE"}.}

\item{tol}{Numeric. Convergence tolerance (default 1e-8).}

\item{eps_fun}{Function that returns the ε to use. Possible options are 
\code{\link{eps_fixed}}, \code{\link{eps_fixed}}, \code{\link{eps_fixed}},
or a user-defined function. It is called as
     `eps_fun(n = length(data), data = data,
              support_boundary = support_boundary,
              thresh = thresh, !!!eps_par)`.}

\item{eps_par}{List of additional named arguments forwarded to `eps_fun`.}

\item{constraint}{Character. Type of constraint to enforce during GPD fitting.
Options are \code{"unconstrained"}, \code{"shape_nonneg"},
\code{"support_at_obs"}, and \code{"support_at_max"}.}

\item{support_boundary}{Numeric or NULL. Upper boundary of the GPD support,
used in constrained fitting when the shape parameter is negative. If NULL,
the maximum of the data vector is used.}

\item{gof_test}{Character. Specifies the goodness-of-fit test to apply.
Options are \code{"ad"} (Anderson-Darling), \code{"cvm"} (Cramér-von Mises),
or \code{"none"}. Default is \code{"ad"}.}

\item{...}{Further arguments passed to low-level fitting helpers.}
}
\value{
A named list with components:
  \describe{
    \item{\code{shape}}{Estimated shape parameter of the GPD.}
    \item{\code{scale}}{Estimated scale parameter of the GPD.}
    \item{\code{p_value}}{P-value from the goodness-of-fit test, if applicable.}
    \item{\code{epsilon}}{Epsilon used for each test.}
  }
}
\description{
Fits the Generalized Pareto Distribution (GPD) to exceedances over a given threshold
using one of several available estimation methods. Optionally applies a goodness-of-fit test
to assess the adequacy of the fitted model.
}
\details{
If the shape parameter is negative (indicating a bounded tail), a constraint
may be imposed to ensure that the support of the GPD does not exceed a specified
maximum value. The \code{support_boundary} argument defines this bound and is
only relevant for such constrained fitting. The default behavior uses the
maximum observed data value unless otherwise specified.
}
