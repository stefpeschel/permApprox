% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eps_functions.R
\name{eps_slls}
\alias{eps_slls}
\title{Standardized Lifted Log-Saturation (SLLS) epsilon rule}
\usage{
eps_slls(
  obs_stats,
  perm_stats,
  sample_size,
  k_factor = 1000,
  target_factor = 0.25,
  rho_lift = 3,
  floor_epsZ = 1e-06,
  q_ref = 0.99,
  n_ref = 100,
  anchor_mult = 5,
  beta = 0.5,
  ...
)
}
\arguments{
\item{obs_stats}{Numeric vector of observed test statistics.}

\item{perm_stats}{Matrix of permutation test statistics with one column per test 
and one row per permutation replicate.}

\item{sample_size}{Per-group sample size of the test (used to scale curvature and plateau).}

\item{k_factor}{Numeric scalar. Controls the curvature of the saturation curve.
Larger values bend the curve earlier. Default is \code{1000}.}

\item{target_factor}{Numeric scalar. Controls the plateau height at the anchor 
point. Larger values yield more conservative \eqn{\varepsilon}. Default is \code{0.25}.}

\item{rho_lift}{Numeric scalar. Multiplier for the Wendland-\eqn{C^2} lift term, 
which prevents underestimation of \eqn{\varepsilon} for small and moderate test 
statistics. Default is \code{3}.}

\item{floor_epsZ}{Numeric scalar. Minimum allowed value on the \emph{Z}-scale 
to avoid vanishingly small \eqn{\varepsilon}. Default is \code{1e-6}.}

\item{q_ref}{Numeric scalar between 0 and 1. Quantile of the absolute standardized 
permutation statistics used as the baseline cap. Default is \code{0.99}.}

\item{n_ref}{Reference sample size used to anchor the inflation factor. 
Default is \code{100}.}

\item{anchor_mult}{Numeric scalar. Multiplier at the reference sample size 
(\code{n_ref}). Default is \code{5}.}

\item{beta}{Numeric scalar. Growth exponent for the inflation factor. 
\code{beta = 0.5} corresponds to \eqn{\sqrt{n}} scaling. Default is \code{0.5}.}

\item{...}{Further arguments passed to internal methods (currently unused).}
}
\value{
Numeric vector of \eqn{\varepsilon}-values on the scale of the original 
  test statistics (same length as \code{obs_stats}).
}
\description{
Computes \eqn{\varepsilon}-values using the 
\emph{Standardized Lifted Log-Saturation (SLLS)} 
rule. The rule operates on the standardized \emph{Z}-scale, combines 
logarithmic saturation with a sample-sizeâ€“dependent plateau, and adds a 
smooth Wendland-\eqn{C^2} lift term to stabilize small and moderate test 
statistics. The saturation anchor is defined by a high quantile of the 
permutation distribution, inflated by a simple sample-size dependent scaling.
}
\details{
The SLLS rule first standardizes test statistics using the mean and standard 
deviation of their permutation distribution. It then defines a reference point 
\eqn{Z_\mathrm{cap}} as a high quantile of the standardized permutation values, 
inflated by a sample-size dependent factor. A log-saturation curve is calibrated 
to this anchor, and a Wendland-\eqn{C^2} kernel is added as a lift term for 
small and moderate values. The result is mapped back to the original test 
statistic scale.
}
\examples{
set.seed(123)
perm <- matrix(rnorm(1000 * 5), nrow = 1000, ncol = 5)
obs  <- rnorm(5, mean = 2)
eps_slls(obs, perm, sample_size = 50)

}
